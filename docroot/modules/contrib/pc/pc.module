<?php

/**
 * @file
 * Primary hooks for PHP Console module.
 */

/**
 * Print a variable to the browser console.
 *
 * @param mixed $variable
 *   An arbitrary value to output.
 * @param string $label
 *   Optional $label for identifying the output.
 */
function pc($variable, $label = ' ') {
  /** @var \PhpConsole\Connector $connector */
  $connector = \Drupal::service('pc.connector_factory')->get();

  // Initialize only for clients with Chrome extension installed.
  if ($connector && $connector->isActiveClient()) {
    $connector
      ->getDebugDispatcher()
      ->dispatchDebug($variable, $label);
  }
}

/**
 * Implements hook_form_alter().
 */
function pc_form_alter(&$form) {
  $debugging_info = \Drupal::config('pc.settings')->get('debug_info');
  if ($debugging_info['forms']) {
    pc($form, 'Form');
  }
}

/**
 * Implements hook_mail_alter().
 */
function pc_mail_alter(&$message) {
  $debugging_info = \Drupal::config('pc.settings')->get('debug_info');
  if ($debugging_info['emails']) {
    pc($message, 'Email');
  }
}
